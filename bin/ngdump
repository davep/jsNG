#!/usr/bin/env node

const NG     = require( "../lib/jsNG" );
const ngdump = require( "commander" );

ngdump
    .usage( "<file ...>")
    .version( "0.0.3" )
    .description( "Dump the contents of the given Norton Guide files" )
    .parse( process.argv );

if ( ngdump.args.length > 0 ) {

    try {
        for ( file of ngdump.args ) {

            const ng = new NG.Guide( file ).open();

            if ( ng.isNG() ) {

                ng.goFirst();

                while ( !ng.eof() ) {

                    const entry = ng.loadEntry();

                    entry.lines().forEach( l => console.log( l ) );

                    if ( entry.hasSeeAlso() ) {
                        console.log( "See Also: " + entry.seeAlso().prompts().join( ", " ) );
                    }

                    ng.nextEntry();
                }
            }
        }
    } catch ( e ) {
        console.log( "Error: " + e.message );
        process.exitCode = 1;
    }
} else {
    ngdump.help();
}
