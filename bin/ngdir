#!/usr/bin/env node

const NG    = require( "../lib/jsNG" );
const ngdir = require( "commander" );

ngdir
    .usage( "<file ...>")
    .version( "0.0.3" )
    .description( "List details of given Norton Guide files" )
    .option( "-i, --ignore-non-ng", "Don't include non-NG files in the list." )
    .parse( process.argv );

const basename = ( s )      => s.split( "/" ).pop();
const padr     = ( s, len ) => ( s + new Array( len + 1 ).join( " " ) ).slice( 0, len );
const list     = ( file, type, desc ) => console.log( padr( basename( file ), 15 ) + "\t" + type + "\t" + desc );

try {

    for ( let file of ngdir.args ) {

        const ng = new NG( file ).open();

        if ( ng.isNG() ) {
            list( file, ng.type(), ng.title() );
        } else if ( !ngdir.ignoreNonNg ) {
            list( file, "Not an NG", "" );
        }
    }

} catch ( e ) {
    console.log( "Error: " + e.message );
    process.exitCode = 1;
}
